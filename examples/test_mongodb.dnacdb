
MAKE COLLECTION analytics;

MAKE COLLECTION sessions;

MAKE COLLECTION user_activity;

PUT INTO analytics DATA {"event": "page_view", "page": "/home", "user_id": 123, "timestamp": "2025-11-14T10:00:00"};
PUT INTO analytics DATA {"event": "click", "element": "signup_button", "user_id": 123, "timestamp": "2025-11-14T10:05:00"};
PUT INTO analytics DATA {"event": "purchase", "product_id": 456, "amount": 99.99, "user_id": 123, "timestamp": "2025-11-14T10:10:00"};
PUT INTO analytics DATA {"event": "page_view", "page": "/products", "user_id": 789, "referrer": "google", "timestamp": "2025-11-14T10:15:00"};

PUT INTO sessions DATA {"user_id": 123, "session_start": "2025-11-14T10:00:00", "duration_seconds": 600, "device": {"type": "mobile", "os": "iOS", "browser": "Safari"}};
PUT INTO sessions DATA {"user_id": 789, "session_start": "2025-11-14T10:15:00", "duration_seconds": 300, "device": {"type": "desktop", "os": "Windows", "browser": "Chrome"}};

PUT INTO user_activity DATA {"user_id": 123, "activities": ["login", "view_product", "add_to_cart", "purchase"], "tags": ["premium", "loyal"]};
PUT INTO user_activity DATA {"user_id": 789, "activities": ["login", "search", "view_product"], "tags": ["new_user"]};

FETCH FROM analytics ALL;

FETCH FROM analytics WHERE event = "purchase";

FETCH FROM analytics WHERE user_id = 123;

FETCH FROM sessions ALL;

FETCH FROM user_activity ALL;

CHANGE IN analytics SET event = "completed_purchase" WHERE product_id = 456;

FETCH FROM analytics WHERE product_id = 456;



PUT INTO analytics DATA {"event": "error", "error_details": {"code": 500, "message": "Internal server error", "stack_trace": "Error at line 42", "context": {"user_id": 123, "action": "checkout"}}, "severity": "high"};

PUT INTO sessions DATA {"user_id": 999, "session_start": "2025-11-14T11:00:00", "actions": [{"type": "click", "target": "button", "timestamp": "2025-11-14T11:01:00"}, {"type": "scroll", "distance": 500, "timestamp": "2025-11-14T11:02:00"}], "score": 85.5};


FETCH FROM analytics WHERE event = "error";
FETCH FROM sessions WHERE user_id = 999;


REMOVE FROM analytics WHERE event = "page_view";

FETCH FROM analytics ALL;

SHOW COLLECTIONS;